(library
 (name routeguide)
 (libraries ocaml-protoc-plugin))

(rule
 (targets route_guide.ml)
 (deps
  (:proto route_guide.proto))
 (action
  (run
    protoc
    -I
    .
    "--ocaml_out=annot=[@@deriving show { with_path = false }]:."
    %{proto})))

; (rule
;  (targets
;    helloworld_pb.ml
;    helloworld_pb.mli
;    helloworld_pp.ml
;    helloworld_pp.mli
;    helloworld_types.ml
;    helloworld_types.mli)
;  (action
;   (run ocaml-protoc -binary -pp -ml_out ./ helloworld.proto))
;  (deps helloworld.proto))
